# AUTOGENERATED! DO NOT EDIT! File to edit: ../../../nbs/02 training.transcription.index.ipynb.

# %% auto 0
__all__ = ['random_state', 'get_intron_locations']

# %% ../../../nbs/02 training.transcription.index.ipynb 3
from pathlib import Path
import pandas as pd
from tqdm import tqdm

tqdm.pandas()

from ...data.download import load_config, \
    get_latest_assembly_path, get_genomic_genbank_path

random_state = 42

# %% ../../../nbs/02 training.transcription.index.ipynb 8
def get_intron_locations(directory: Path, chromosome: str = None) -> pd.DataFrame:
    # Index files
    chromosome_parquet_files = list(directory.glob("*.parquet"))
    if isinstance(chromosome, str):
        chromosome_parquet_files = [p for p in chromosome_parquet_files if p.stem.endswith(chromosome)]
    frames = []
    for f in chromosome_parquet_files:
        f_frame = pd.read_parquet(f)
        if f_frame.shape[0] > 0:
            f_frame.loc[:, 'chromosome'] = f.stem.replace("chromosome-", "")
            frames.append(f_frame)
    intron_locations = pd.concat(frames).reset_index(drop=True)
    return intron_locations
